$(document).ready(function(){$(".nav").setup_navigation(),$("body").addClass("js");var e=$("#menu"),t=$(".menu-link"),a=$(".has-subnav > a");t.click(function(a){a.preventDefault(),t.toggleClass("active"),e.toggleClass("active")}),a.click(function(e){e.preventDefault();var t=$(this);t.toggleClass("active").next("ul").toggleClass("active")})});var keyCodeMap={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};$.fn.setup_navigation=function(e){e=jQuery.extend({menuHoverClass:"show-menu"},e),$(this).attr("role","menubar").find("li").attr("role","menuitem");var t=$(this).find("> li > a");$(t).next("ul").attr("data-test","true").attr({"aria-hidden":"true",role:"menu"}).find("a").attr("tabIndex",-1),$(t).each(function(){$(this).next("ul").length>0&&$(this).parent("li").attr("aria-haspopup","true")}),$(t).hover(function(){$(this).closest("ul").attr("aria-hidden","false").find("."+e.menuHoverClass).attr("aria-hidden","true").removeClass(e.menuHoverClass).find("a").attr("tabIndex",-1),$(this).next("ul").attr("aria-hidden","false").addClass(e.menuHoverClass).find("a").attr("tabIndex",0)}),$(t).focus(function(){$(this).closest("ul").find("."+e.menuHoverClass).attr("aria-hidden","true").removeClass(e.menuHoverClass).find("a").attr("tabIndex",-1),$(this).next("ul").attr("aria-hidden","false").addClass(e.menuHoverClass).find("a").attr("tabIndex",0)}),$(t).keydown(function(t){37==t.keyCode?(t.preventDefault(),0==$(this).parent("li").prev("li").length?$(this).parents("ul").find("> li").last().find("a").first().focus():$(this).parent("li").prev("li").find("a").first().focus()):38==t.keyCode?(t.preventDefault(),$(this).parent("li").find("ul").length>0&&$(this).parent("li").find("ul").attr("aria-hidden","false").addClass(e.menuHoverClass).find("a").attr("tabIndex",0).last().focus()):39==t.keyCode?(t.preventDefault(),0==$(this).parent("li").next("li").length?$(this).parents("ul").find("> li").first().find("a").first().focus():$(this).parent("li").next("li").find("a").first().focus()):40==t.keyCode?(t.preventDefault(),$(this).parent("li").find("ul").length>0&&$(this).parent("li").find("ul").attr("aria-hidden","false").addClass(e.menuHoverClass).find("a").attr("tabIndex",0).first().focus()):13==t.keyCode||32==t.keyCode?(t.preventDefault(),$(this).parent("li").find("ul[aria-hidden=true]").attr("aria-hidden","false").addClass(e.menuHoverClass).find("a").attr("tabIndex",0).first().focus()):27==t.keyCode?(t.preventDefault(),$("."+e.menuHoverClass).attr("aria-hidden","true").removeClass(e.menuHoverClass).find("a").attr("tabIndex",-1)):$(this).parent("li").find("ul[aria-hidden=false] a").each(function(){if($(this).text().substring(0,1).toLowerCase()==keyCodeMap[t.keyCode])return $(this).focus(),!1})});var a=$(t).parent("li").find("ul").find("a");$(a).keydown(function(t){if(38==t.keyCode)t.preventDefault(),0==$(this).parent("li").prev("li").length?$(this).parents("ul").parents("li").find("a").first().focus():$(this).parent("li").prev("li").find("a").first().focus();else if(40==t.keyCode)t.preventDefault(),0==$(this).parent("li").next("li").length?$(this).parents("ul").parents("li").find("a").first().focus():$(this).parent("li").next("li").find("a").first().focus();else if(27==t.keyCode||37==t.keyCode)t.preventDefault(),$(this).parents("ul").first().prev("a").focus().parents("ul").first().find("."+e.menuHoverClass).attr("aria-hidden","true").removeClass(e.menuHoverClass).find("a").attr("tabIndex",-1);else if(32==t.keyCode)t.preventDefault(),window.location=$(this).attr("href");else{var a=!1;$(this).parent("li").nextAll("li").find("a").each(function(){if($(this).text().substring(0,1).toLowerCase()==keyCodeMap[t.keyCode])return $(this).focus(),a=!0,!1}),a||$(this).parent("li").prevAll("li").find("a").each(function(){if($(this).text().substring(0,1).toLowerCase()==keyCodeMap[t.keyCode])return $(this).focus(),!1})}}),$(this).find("a").last().keydown(function(t){9==t.keyCode&&$("."+e.menuHoverClass).attr("aria-hidden","true").removeClass(e.menuHoverClass).find("a").attr("tabIndex",-1)}),$(document).click(function(){$("."+e.menuHoverClass).attr("aria-hidden","true").removeClass(e.menuHoverClass).find("a").attr("tabIndex",-1)}),$(this).click(function(e){e.stopPropagation()})};